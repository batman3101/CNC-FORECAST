# PRD: AI Agent Web App - Forecast 매출 계산 시스템

## 문서 정보

| 항목 | 내용 |
|------|------|
| 버전 | 1.2 |
| 최종수정일 | 2025-11-29 |
| 작성자 | ALMUS TECH |
| 상태 | 초안 |

---

## 1. 개요

### 1.1 프로젝트 목적

AI Agent 웹앱 기능:
1. 비정형 Excel Forecast 데이터 업로드
2. LLM이 데이터 구조 자동 분석
3. 단가 DB(Excel)와 매칭
4. 일간/주간/월간 매출 계산
5. 실적 매출 vs 예상 매출 구분
6. 누적 데이터 관리
7. **[신규 v1.2] Excel 패턴 학습으로 처리 속도 향상**

### 1.2 핵심 문제

- Forecast Excel 파일이 담당자마다 형식이 다름 (비정형)
- 수식, 병합셀, 다양한 레이아웃으로 파싱 실패 빈번
- 수작업 데이터 정리로 시간 낭비
- 실적 결과 + 미래 예상을 통합 확인할 수 없음
- **[신규 v1.2] 동일 Excel 형식에 반복적 LLM 호출 = 느리고 비용 발생**

### 1.3 솔루션

LLM(Claude)을 활용하여 비정형 Excel의 "의미"를 파악하고 정형화된 데이터 자동 추출.
**[신규 v1.2] 성공한 패턴을 템플릿으로 저장하여 즉시 재사용.**

---

## 2. 사용자 및 환경

### 2.1 타겟 사용자

- 1인 사용
- 생산관리 담당자

### 2.2 환경

- Windows PC (독립 실행파일)
- 로컬 실행 (localhost)
- 인터넷 필수 (Claude API)

### 2.3 사용 빈도

- 주간 (새 forecast 도착 시)
- 일간 (실적 확인용)

---

## 3. 배포 및 실행

### 3.1 실행파일 패키지

애플리케이션은 독립 실행형 Windows 실행파일로 패키징됩니다.

**배포 형식:**
```
ForecastCalculator/
├── ForecastCalculator.exe    # 메인 런처 (더블클릭으로 실행)
├── icon.ico                   # 바탕화면 바로가기 아이콘
├── config/
│   └── settings.json          # 사용자 설정
├── data/
│   ├── price_master.xlsx      # 단가 DB
│   ├── history.db             # 누적 데이터 (SQLite)
│   └── templates.db           # [신규] 학습된 템플릿
└── README.txt                 # 빠른 시작 가이드
```

### 3.2 원클릭 실행

**사용자 경험:**
1. `ForecastCalculator.exe` 더블클릭
2. 시스템이 백엔드 서버 자동 시작
3. 브라우저 자동 열림 (http://localhost:8000)
4. 바로 사용 가능

**시스템 트레이:**
- 앱이 시스템 트레이에서 실행
- 우클릭 메뉴: 브라우저 열기 / 설정 / 종료
- 트레이 아이콘 종료 시 자동 셧다운

### 3.3 바탕화면 바로가기

**설치 포함 항목:**
- 바탕화면 바로가기 생성
- 시작 메뉴 등록
- 커스텀 아이콘 (forecast 차트 아이콘)

---

## 4. 입력 데이터

### 4.1 Forecast Excel (업로드)

- 4주간 생산 forecast
- 비정형 형식
- 포함 항목: 모델명, 날짜/주차, 수량
- 포함 가능: 수식, 병합셀, 다양한 레이아웃

### 4.2 단가 마스터 Excel (DB)

- 고정 형식 (정형)
- 위치: `./data/price_master.xlsx`
- 포함 항목: 모델명, 공정, 단가

**단가 마스터 구조:**

| 모델 | 공정 | 단가(원) |
|------|------|----------|
| AAA-01 | CNC | 1,200 |
| AAA-01 | 조립 | 800 |
| BBB-02 | CNC | 1,500 |

### 4.3 실적 생산 데이터

**데이터 입력 방법:**
1. 웹 UI를 통한 수동 입력
2. Excel 업로드 (실제 출하 데이터)
3. ERP 자동 연동 (v2.0)

**실적 데이터 구조:**

| 날짜 | 모델 | 출하수량 | 매출 |
|------|------|----------|------|
| 2025-11-28 | AAA-01 | 980 | 1,960,000 |
| 2025-11-28 | BBB-02 | 510 | 765,000 |

---

## 5. 출력 데이터

### 5.1 매출 리포트

**리포트 유형:**

| 유형 | 설명 | 데이터 소스 |
|------|------|-------------|
| 실적 매출 | 완료된 생산/출하 | 히스토리 DB |
| 예상 매출 | 미래 계획 생산 | 업로드된 Forecast |
| 통합 뷰 | 실적 + 예상을 한 화면에 | 둘 다 |

**시간 기반 분류:**
```
과거 날짜 (오늘 이전)     → 실적 매출 (확정)
오늘                     → 실적 매출 (입력된 경우) 또는 예상
미래 날짜 (오늘 이후)     → 예상 매출 (계획)
```

### 5.2 리포트 화면

```
+----------------------------------------------------------+
|  매출 리포트: 2025-11 ~ 2025-12                           |
+----------------------------------------------------------+
|  [실적] [예상] [통합]  ← 보기 모드 전환                    |
+----------------------------------------------------------+
|                                                           |
|  날짜    | 모델   | 구분    | 수량  | 매출               |
|----------|--------|---------|-------|-------------------|
|  11/25   | AAA-01 | 실적    | 1,000 | 2,000,000  ✓     |
|  11/26   | AAA-01 | 실적    | 1,100 | 2,200,000  ✓     |
|  11/27   | AAA-01 | 실적    | 950   | 1,900,000  ✓     |
|  11/28   | AAA-01 | 실적    | 980   | 1,960,000  ✓     |
|  11/29   | AAA-01 | 오늘    | -     | (대기중)          |
|  11/30   | AAA-01 | 예상    | 1,200 | 2,400,000  ~     |
|  12/01   | AAA-01 | 예상    | 1,300 | 2,600,000  ~     |
+----------------------------------------------------------+
|                                                           |
|  요약:                                                    |
|  - 실적 매출 (확정):     8,060,000원                      |
|  - 예상 매출 (계획):     5,000,000원                      |
|  - 총 예상:             13,060,000원                      |
|                                                           |
+----------------------------------------------------------+

범례:  ✓ = 확정 (실적)   ~ = 예상 (계획)
```

### 5.3 대시보드 지표

| 지표 | 설명 |
|------|------|
| MTD 실적 | 월누계 실적 매출 |
| MTD 예상 | 남은 월 예상 매출 |
| 월간 목표 | MTD 실적 + MTD 예상 |
| 달성률 | MTD 실적 / 월간 목표 |
| 차이 | 실적 vs 원래 예상 |

---

## 6. 템플릿 학습 시스템 (신규 v1.2)

### 6.1 개념 개요

시스템이 성공적인 파싱 패턴을 재사용 가능한 템플릿으로 저장하여 Excel 형식을 "학습"합니다. 이것은 진정한 AI 학습이 아니라 유사한 결과를 달성하는 패턴 매칭입니다.

**장점:**
- 반복 형식은 즉시 처리 (LLM 호출 없음)
- API 비용 절감
- 시간이 지날수록 정확도 향상
- 처리 속도 향상

### 6.2 작동 방식

```
[첫 번째 업로드 - 새로운 형식]
┌─────────────────────────────────────────────┐
│ 1. 사용자가 Excel 업로드                     │
│ 2. 시스템이 템플릿 DB 확인 → 매칭 없음       │
│ 3. LLM이 구조 분석 (Vision API)             │
│ 4. 사용자가 결과 검토 및 확인               │
│ 5. 프롬프트: "이 형식을 저장할까요?"         │
│ 6. 사용자가 "이 형식 기억하기" 클릭          │
│ 7. 템플릿이 DB에 저장됨                     │
└─────────────────────────────────────────────┘

[두 번째 업로드 - 동일 형식]
┌─────────────────────────────────────────────┐
│ 1. 사용자가 Excel 업로드                     │
│ 2. 시스템이 템플릿 DB 확인 → 매칭 발견!      │
│ 3. 저장된 템플릿으로 직접 파싱               │
│ 4. LLM 호출 불필요                          │
│ 5. 즉시 결과 (< 1초)                        │
└─────────────────────────────────────────────┘
```

### 6.3 템플릿 매칭 로직

**핑거프린트 생성:**
```
Excel 핑거프린트 = 해시값:
  - 시트 구조 (행/열 개수 범위)
  - 헤더 패턴 (1-3행의 텍스트)
  - 데이터 유형 패턴 (텍스트 vs 숫자 위치)
  - 병합셀 패턴
  - 키워드 존재 여부 (모델 코드, 날짜 형식)
```

**매칭 프로세스:**
```
1. 업로드된 파일의 핑거프린트 생성
2. 저장된 템플릿과 비교
3. 유사도 점수 계산 (0-100%)

점수 >= 90%  → 템플릿 직접 사용
점수 70-89%  → 템플릿 사용 + LLM 검증
점수 < 70%   → 전체 LLM 분석 (새 형식)
```

### 6.4 템플릿 데이터 구조

```json
{
  "template_id": "tpl_001",
  "name": "주간 Forecast - 생산팀",
  "fingerprint": "a1b2c3d4e5...",
  "created_at": "2025-11-29",
  "use_count": 47,
  "last_used": "2025-11-29",
  "accuracy_rate": 0.98,
  "mapping": {
    "model_column": "A",
    "model_start_row": 3,
    "date_row": 1,
    "date_start_column": "B",
    "quantity_start_cell": "B3",
    "header_keywords": ["모델", "주차", "수량"],
    "date_format": "N주차",
    "skip_rows": [1, 2],
    "skip_columns": ["합계", "Total"]
  }
}
```

### 6.5 신뢰도 기반 자동화

| 신뢰도 | 동작 | 사용자 상호작용 |
|--------|------|-----------------|
| >= 95% | 자동 처리 | 없음 (결과만 표시) |
| 80-94% | 자동 처리 | 검토 요청 |
| 60-79% | LLM + 템플릿 | 매핑 확인 |
| < 60% | 전체 LLM | 수동 검증 |

### 6.6 템플릿 관리 UI

```
+--------------------------------------------------+
|  저장된 템플릿                                    |
+--------------------------------------------------+
|                                                  |
|  +--------------------------------------------+  |
|  | 이름              | 사용 | 정확도 | 작업  |  |
|  |-------------------|------|--------|-------|  |
|  | 주간 Forecast     | 47회 | 98%    | [수정]|  |
|  | 월간 요약         | 12회 | 95%    | [수정]|  |
|  | 일간 생산         | 89회 | 99%    | [수정]|  |
|  +--------------------------------------------+  |
|                                                  |
|  [템플릿 가져오기]  [전체 내보내기]               |
|                                                  |
+--------------------------------------------------+
```

### 6.7 지속적 개선

**피드백 루프:**
```
1. 사용자가 파싱 오류 수정
2. 시스템이 템플릿 정확도 점수 업데이트
3. 낮은 정확도 템플릿 검토 플래그 지정
4. 70% 미만 정확도 템플릿 자동 비활성화
5. 사용자가 불량 템플릿 재학습 또는 삭제 가능
```

**학습 지표:**
- 템플릿 히트율 (매칭된 업로드 %)
- 평균 처리 시간
- 절약된 API 호출 수
- 시간에 따른 정확도 추이

---

## 7. 누적 데이터 관리

### 7.1 데이터 저장소

**SQLite 데이터베이스:** `./data/history.db`

**테이블:**

```sql
-- 실적 생산/출하 기록
CREATE TABLE actual_records (
    id INTEGER PRIMARY KEY,
    date DATE NOT NULL,
    model VARCHAR(50) NOT NULL,
    quantity INTEGER NOT NULL,
    unit_price INTEGER NOT NULL,
    revenue INTEGER NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Forecast 스냅샷 (차이 분석용)
CREATE TABLE forecast_snapshots (
    id INTEGER PRIMARY KEY,
    upload_date DATE NOT NULL,
    forecast_date DATE NOT NULL,
    model VARCHAR(50) NOT NULL,
    quantity INTEGER NOT NULL,
    revenue INTEGER NOT NULL
);

-- 일간 요약 캐시
CREATE TABLE daily_summary (
    date DATE PRIMARY KEY,
    total_actual_qty INTEGER,
    total_actual_revenue INTEGER,
    total_forecast_qty INTEGER,
    total_forecast_revenue INTEGER
);
```

### 7.2 데이터 작업

| 작업 | 설명 |
|------|------|
| 실적 추가 | 오늘 생산 결과 입력 |
| 실적 수정 | 과거 기록 수정 (감사 로그 포함) |
| 실적 삭제 | 잘못된 항목 제거 |
| 히스토리 조회 | 날짜 범위로 과거 기록 검색 |
| 내보내기 | 히스토리 데이터를 Excel로 다운로드 |

### 7.3 데이터 보존

- 기본: 모든 히스토리 데이터 보관
- 선택: 1년 이상 된 데이터 아카이브
- 백업: 앱 시작 시 자동 백업

---

## 8. 핵심 기능

### 8.1 Excel 업로드

- 드래그 앤 드롭 또는 파일 선택
- 지원: .xlsx, .xls
- 파일 크기 제한: 10MB
- **[신규 v1.2] LLM 호출 전 템플릿 매칭**

### 8.2 LLM 데이터 분석

**접근법: Vision + LLM**

1. Excel 시트를 이미지(스크린샷)로 변환
2. **[신규 v1.2] 먼저 템플릿 DB 확인**
3. 매칭 없으면: Claude Vision API로 전송
4. LLM이 식별: 모델명, 날짜, 수량
5. 출력: 정형화된 JSON
6. **[신규 v1.2] 템플릿으로 저장 제안**

**Vision 접근법을 쓰는 이유?**
- 병합셀을 자연스럽게 처리
- 수식을 표시된 값으로 읽음
- Excel 구조와 무관하게 작동

### 8.3 단가 매칭

- forecast의 모델명을 단가 DB와 매칭
- 계산: 수량 x 단가 = 매출

### 8.4 매출 계산

```
일간 매출 = SUM(각 모델의 수량 x 단가)
주간 매출 = SUM(해당 주의 일간 매출)
월간 매출 = SUM(해당 월의 주간 매출)
```

### 8.5 실적 데이터 입력

**입력 방법:**

1. **빠른 입력 폼**
   - 날짜 선택 (기본값: 오늘)
   - 모델 + 수량 입력
   - 단가 마스터에서 매출 자동 계산

2. **일괄 업로드**
   - 실제 출하 Excel 업로드
   - forecast와 동일한 LLM 분석
   - **[신규 v1.2] 저장된 템플릿 사용 가능**

3. **Forecast에서 복사**
   - 원클릭으로 forecast를 실적으로 복사
   - 필요시 수량 수정

---

## 9. UI/UX 디자인

### 9.1 메인 화면

```
+--------------------------------------------------+
|  [아이콘] Forecast 매출 계산기         [_][X]     |
+--------------------------------------------------+
|                                                  |
|  +--------------------+  +--------------------+  |
|  |    새 Forecast     |  |    실적 입력       |  |
|  |    업로드          |  |                    |  |
|  +--------------------+  +--------------------+  |
|                                                  |
|  +--------------------------------------------+  |
|  |              빠른 대시보드                  |  |
|  |  +----------+  +----------+  +----------+  |  |
|  |  | MTD      |  | 오늘     |  | 월간     |  |  |
|  |  | 실적     |  | 상태     |  | 목표     |  |  |
|  |  | 4520만   |  | 대기중   |  | 1.2억    |  |  |
|  |  +----------+  +----------+  +----------+  |  |
|  +--------------------------------------------+  |
|                                                  |
|  [전체 리포트]  [단가 마스터]  [히스토리]         |
|  [템플릿]  ← 신규 v1.2                           |
|                                                  |
+--------------------------------------------------+
```

### 9.2 업로드 화면 - 템플릿 포함 (신규 v1.2)

```
+--------------------------------------------------+
|  Forecast 업로드                                  |
+--------------------------------------------------+
|                                                  |
|  +--------------------------------------------+  |
|  |                                            |  |
|  |     Excel 파일을 드래그하거나              |  |
|  |        클릭하여 선택하세요                 |  |
|  |                                            |  |
|  +--------------------------------------------+  |
|                                                  |
|  [✓] 저장된 템플릿 자동 감지                     |
|                                                  |
|  최근 템플릿:                                    |
|  +--------------------------------------------+  |
|  | [★] 주간 Forecast (정확도 98%)             |  |
|  | [ ] 월간 요약 (정확도 95%)                 |  |
|  | [ ] 새 형식 사용 (LLM 분석)                |  |
|  +--------------------------------------------+  |
|                                                  |
+--------------------------------------------------+
```

### 9.3 템플릿 저장 프롬프트 (신규 v1.2)

```
+--------------------------------------------------+
|  분석 완료!                                       |
+--------------------------------------------------+
|                                                  |
|  24개 레코드 추출 (신뢰도 95%)                    |
|                                                  |
|  +--------------------------------------------+  |
|  | 모델   | 1주차  | 2주차  | 3주차  | 4주차  |  |
|  |--------|--------|--------|--------|--------|  |
|  | AAA-01 | 1,000  | 1,200  | 1,100  | 1,300  |  |
|  | BBB-02 | 500    | 600    | 550    | 650    |  |
|  +--------------------------------------------+  |
|                                                  |
|  +--------------------------------------------+  |
|  |  [★] 이 형식을 다음에도 사용하기 위해 저장  |  |
|  |                                            |  |
|  |  템플릿 이름: [주간 Forecast__________]    |  |
|  +--------------------------------------------+  |
|                                                  |
|  [데이터 수정]                [확인 및 계산]     |
|                                                  |
+--------------------------------------------------+
```

### 9.4 실적 입력 화면

```
+--------------------------------------------------+
|  실적 생산 입력                                   |
+--------------------------------------------------+
|  날짜: [2025-11-29 ▼]                            |
|                                                  |
|  +--------------------------------------------+  |
|  | 모델     | 예상    | 실적   | 매출         |  |
|  |----------|---------|--------|--------------|  |
|  | AAA-01   | 1,000   | [    ] | 자동계산     |  |
|  | BBB-02   | 500     | [    ] | 자동계산     |  |
|  | CCC-03   | 300     | [    ] | 자동계산     |  |
|  +--------------------------------------------+  |
|                                                  |
|  [Forecast에서 전체 복사]                        |
|                                                  |
|  [취소]                          [저장]          |
+--------------------------------------------------+
```

### 9.5 히스토리 화면

```
+--------------------------------------------------+
|  히스토리 데이터                                  |
+--------------------------------------------------+
|  기간: [2025-11-01] ~ [2025-11-29]  [검색]       |
|                                                  |
|  +--------------------------------------------+  |
|  | 날짜   | 모델   | 수량  | 매출    | 작업   |  |
|  |--------|--------|-------|---------|--------|  |
|  | 11/28  | AAA-01 | 980   | 196만   | [수정] |  |
|  | 11/28  | BBB-02 | 510   | 77만    | [수정] |  |
|  | 11/27  | AAA-01 | 950   | 190만   | [수정] |  |
|  +--------------------------------------------+  |
|                                                  |
|  총 건수: 156                                    |
|  총 매출: 45,230,000원                           |
|                                                  |
|  [Excel 내보내기]            [< 이전] [다음 >]   |
+--------------------------------------------------+
```

---

## 10. 에러 처리

### 10.1 LLM 분석 실패

LLM이 데이터 구조를 식별하지 못할 경우:
1. 업로드된 Excel 미리보기 표시
2. 사용자가 컬럼을 수동 선택 가능
3. 매핑 정보 저장하여 재사용

### 10.2 단가 미등록

모델이 단가 DB에 없을 경우:
1. 누락된 모델 강조 표시
2. 사용자가 인라인으로 단가 추가 가능
3. 가용 데이터로 계산 계속 진행

### 10.3 중복 입력

해당 날짜 + 모델에 실적 데이터가 이미 있을 경우:
1. 기존 데이터와 함께 경고 표시
2. 옵션: 덮어쓰기 / 추가 / 취소

### 10.4 템플릿 불일치 (신규 v1.2)

템플릿 매칭 신뢰도가 낮을 경우:
1. 나란히 비교 표시
2. 예상 형식과의 차이점 강조
3. 옵션: 템플릿 그대로 사용 / 전체 LLM 분석 / 수동 매핑

---

## 11. 향후 확장 계획 (v2.0)

- [ ] 다중 forecast 파일 비교
- [ ] 트렌드 분석 차트
- [ ] 자동 이메일 리포트
- [ ] Google Sheets 연동 옵션
- [ ] 실적 데이터 ERP 자동 연동
- [ ] 차이 분석 (예상 vs 실적)
- [ ] 다중 사용자 지원 (로그인)
- [ ] **[신규 v1.2] 사용자 간 템플릿 공유/내보내기**
- [ ] **[신규 v1.2] 템플릿 개선 자동 제안**

---

## 12. 개발 단계

### 1단계: MVP (1-2주차)

- 기본 Excel 업로드
- LLM 분석 (Vision 접근법)
- 단순 매출 계산
- 기본 결과 표시
- Windows 실행파일 패키징

### 2단계: 기능 강화 (3-4주차)

- 단가 마스터 CRUD
- Excel 다운로드
- 에러 처리 UI
- 차트 시각화
- 실적 데이터 입력
- 히스토리 데이터 저장

### 3단계: 완성도 개선 (5-6주차)

- 실적 + 예상 통합 뷰
- 대시보드 지표
- 데이터 내보내기 기능
- 시스템 트레이 연동
- 바탕화면 바로가기 설치
- **[신규 v1.2] 기본 템플릿 학습**

### 4단계: 지능화 (7-8주차) (신규 v1.2)

- 템플릿 매칭 엔진
- 신뢰도 점수 시스템
- 템플릿 관리 UI
- 학습 지표 대시보드
- 성능 최적화

---

## 13. 성공 기준

| 지표 | 목표 |
|------|------|
| 데이터 추출 정확도 | > 90% |
| 처리 시간 (새 형식) | < 30초 |
| 처리 시간 (학습된 형식) | < 2초 |
| 사용자 개입 필요 | < 10% 업로드 건 |
| 앱 시작 시간 | < 5초 |
| 원클릭 실행 | 첫 시도에 성공 |
| **[신규 v1.2] 템플릿 히트율** | 1개월 후 > 70% |
| **[신규 v1.2] API 비용 절감** | 1개월 후 > 50% |

---

## 부록 A: 샘플 데이터

### Forecast Excel 예시

시스템이 처리해야 할 다양한 형식:

**형식 1: 단순 테이블**
```
모델   | 1주차 | 2주차 | 3주차 | 4주차
AAA-01 | 1000  | 1200  | 1100  | 1300
BBB-02 | 500   | 600   | 550   | 650
```

**형식 2: 날짜 기반**
```
날짜       | 모델   | 수량
2025-12-01 | AAA-01 | 200
2025-12-01 | BBB-02 | 100
2025-12-02 | AAA-01 | 250
```

**형식 3: 병합셀 포함**
```
+------------------+------+------+
|      모델        | 1주차       |
|                  | 월   | 화   |
+------------------+------+------+
| AAA-01           | 50   | 60   |
+------------------+------+------+
```

---

## 부록 B: Claude API 프롬프트 템플릿

```
당신은 생산 forecast Excel 스크린샷을 분석합니다.

다음 정보를 JSON으로 추출하세요:
1. model_name: 제품/모델 식별자
2. period: 날짜 또는 주차 정보
3. quantity: 생산 수량

규칙:
- 헤더 행과 합계는 무시
- 병합셀은 값을 올바르게 연결
- 날짜가 주차 번호인 경우 "1주차", "2주차" 등으로 표기

출력 형식:
{
  "data": [
    {
      "model": "AAA-01",
      "period": "2025-12-01",
      "quantity": 1000
    }
  ],
  "confidence": 0.95,
  "notes": "관찰 사항"
}
```

---

## 부록 C: 템플릿 학습 흐름도 (신규 v1.2)

```
┌─────────────────────────────────────────────────────────────┐
│                     EXCEL 파일 업로드                        │
└─────────────────────────────┬───────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                    핑거프린트 생성                           │
│  - 구조, 헤더, 패턴 분석                                     │
└─────────────────────────────┬───────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                  템플릿 데이터베이스 검색                     │
└─────────────────────────────┬───────────────────────────────┘
                              │
              ┌───────────────┼───────────────┐
              │               │               │
              ▼               ▼               ▼
       ┌──────────┐    ┌──────────┐    ┌──────────┐
       │ >= 90%   │    │ 70-89%   │    │ < 70%    │
       │ 매칭     │    │ 부분     │    │ 매칭없음 │
       └────┬─────┘    └────┬─────┘    └────┬─────┘
            │               │               │
            ▼               ▼               ▼
       ┌──────────┐    ┌──────────┐    ┌──────────┐
       │ 직접     │    │ 템플릿   │    │ 전체 LLM │
       │ 파싱     │    │ + 검증   │    │ 분석     │
       └────┬─────┘    └────┬─────┘    └────┬─────┘
            │               │               │
            └───────────────┼───────────────┘
                            │
                            ▼
┌─────────────────────────────────────────────────────────────┐
│                      사용자 검증                             │
│  - 추출된 데이터 검토                                        │
│  - 오류 수정                                                │
└─────────────────────────────┬───────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                  템플릿 업데이트 (필요시)                     │
│  - 새 템플릿 저장 또는                                       │
│  - 정확도 점수 업데이트 또는                                 │
│  - 기존 매핑 개선                                           │
└─────────────────────────────────────────────────────────────┘
```

---

## 변경 이력

| 버전 | 날짜 | 변경 내용 |
|------|------|----------|
| 1.0 | 2025-11-29 | 초안 작성 |
| 1.1 | 2025-11-29 | 추가: Windows 실행파일, 실적 vs 예상 구분, 누적 데이터 관리 |
| 1.2 | 2025-11-29 | 추가: 템플릿 학습 시스템 (패턴 인식) |
